<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cinematic Weather</title>

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Georgia", "Times New Roman", serif;
    }

    body {
        height: 100vh;
        overflow: hidden;
        background: black;
        color: white;
    }

    .scene {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        transition: background-image 1s ease;
    }

    .vignette {
        position: absolute;
        inset: 0;
        background: radial-gradient(
            ellipse at center,
            rgba(0,0,0,0.15),
            rgba(0,0,0,0.7)
        );
        pointer-events: none;
    }

    .grain {
        position: absolute;
        inset: 0;
        background-image: url("https://i.imgur.com/8bKQZ6M.png");
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.6s ease;
        mix-blend-mode: overlay;
    }

    .caption {
        position: absolute;
        top: 48%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 3rem;
        letter-spacing: 0.15em;
        opacity: 0;
        border-bottom: 3px solid rgba(255,255,255,0.85);
        padding-bottom: 12px;
        text-shadow: 0 6px 18px rgba(0,0,0,0.9);
        white-space: nowrap;
        transition: opacity 0.6s ease, letter-spacing 1.8s ease;
    }

    .caption.loaded {
        opacity: 1;
        letter-spacing: 0.04em;
    }

    .caption.hidden {
        opacity: 0;
    }

    .controls {
        position: absolute;
        bottom: 40px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 12px;
    }

    input, button {
        padding: 10px 14px;
        font-size: 1rem;
        border: none;
        outline: none;
    }

    button {
        cursor: pointer;
        background: rgba(255,255,255,0.95);
    }
</style>
</head>
<body>

<div class="scene" id="scene"></div>
<div class="vignette"></div>
<div class="grain" id="grain"></div>

<div class="caption" id="caption">
    HI!
</div>

<div class="controls">
    <input id="cityInput" placeholder="Enter city">
    <button onclick="updateWeather()">Update</button>
</div>
<script>
    const apiKey = "92a2dc11f43333dc593e26b46d7e0f77";
    const apiUrl =
        "https://api.openweathermap.org/data/2.5/weather?units=metric&q=";

    const skyImages = {
        morning: {
            clear:  "https://images.unsplash.com/photo-1667492727913-ae6b3f38afa2",
            cloudy:"https://image.tmdb.org/t/p/original/yPgcWUZA6FyokCarw34UjOIcbaI.jpg",
            rainy: "https://images.unsplash.com/photo-1762274804124-83a2e95109a8"
        },
        afternoon: {
            clear:  "https://image.tmdb.org/t/p/original/mD3wN9w8sOVeDwF4bNs2rDFzD8f.jpg",
            cloudy:"https://image.tmdb.org/t/p/original/6WcAQnoL6DQ9K912V90RpWNpQgU.jpg",
            rainy: "https://images.unsplash.com/photo-1670541218279-46cdd56003a8"
        },
        evening: {
            clear:  "https://image.tmdb.org/t/p/original/3jBJ43UImtFDEIzylB1MlAYX8TT.jpg",
            cloudy:"https://images.unsplash.com/photo-1682218033121-ac3a5b33b7e0",
            rainy: "https://image.tmdb.org/t/p/original/fY01TmPQH3pu2x1e1CacZXkabeC.jpg"
        },
        night: {
            clear:  "https://image.tmdb.org/t/p/original/xs8g06qSblZIkSyFS7YmAo1IgWT.jpg",
            cloudy:"https://image.tmdb.org/t/p/original/afIh8FoiMp3zXLY8aJ1cAnPq3Uc.jpg",
            rainy: "https://image.tmdb.org/t/p/original/1rXQ3fw6VdD6mIb0a9YlanNuPSL.jpg"
        }
    };

    const captions = {
        morning: {
            clear:  "Clear Skies, Soft Morning Light.",
            cloudy:"Partly Cloudy, A Quiet Morning.",
            rainy: "Steady Rain, Muted Morning Light."
        },
        afternoon: {
            clear:  "Clear Skies, Warm Afternoon.",
            cloudy:"Building Clouds, Calm Afternoon.",
            rainy: "Rain Showers, A Grey Afternoon."
        },
        evening: {
            clear:  "Clearing Skies, Cool Evening.",
            cloudy:"Low Clouds, A Slow Evening.",
            rainy: "Rain Continuing, Dimming Evening Light."
        },
        night: {
            clear:  "Clear Skies, Calm Overnight.",
            cloudy:"Cloud Cover, A Still Night.",
            rainy: "Rain Clearing, Breezy Overnight."
        }
    };

    const scene = document.getElementById("scene");
    const caption = document.getElementById("caption");
    const grain = document.getElementById("grain");

    function getTimeBucket(hour) {
        if (hour >= 5 && hour < 12) return "morning";
        if (hour >= 12 && hour < 17) return "afternoon";
        if (hour >= 17 && hour < 20) return "evening";
        return "night";
    }

    function getWeatherBucket(data) {
        const main = data.weather[0].main.toLowerCase();
        if (main.includes("rain") || main.includes("drizzle")) return "rainy";
        if (main.includes("cloud")) return "cloudy";
        return "clear";
    }

    function getCityHour(timezoneOffset) {
        const utc = Date.now() + new Date().getTimezoneOffset() * 60000;
        return new Date(utc + timezoneOffset * 1000).getHours();
    }

    async function updateWeather() {
        const city = cityInput.value.trim();
        if (!city) return;

        try {
            const res = await fetch(apiUrl + city + "&appid=" + apiKey);
            const data = await res.json();

            const hour = getCityHour(data.timezone);
            const time = getTimeBucket(hour);
            const weather = getWeatherBucket(data);

            caption.classList.add("hidden");
            caption.classList.remove("loaded");

            setTimeout(() => {
                scene.style.backgroundImage =
                    `url('${skyImages[time][weather]}')`;

                caption.textContent = captions[time][weather];

                grain.style.opacity = time === "night" ? "0.18" : "0";

                caption.classList.remove("hidden");

                requestAnimationFrame(() => {
                    caption.classList.add("loaded");
                });
            }, 700);

        } catch {
            caption.textContent = "Weather Unavailable.";
        }
    }

// Neutral initial state
scene.style.backgroundImage =
    "url('https://images.pexels.com/photos/53594/blue-clouds-day-fluffy-53594.jpeg')";
caption.textContent = "Enter a City.";


    window.onload = () => {
        setTimeout(() => caption.classList.add("loaded"), 300);
    };
</script>


</body>
</html>
